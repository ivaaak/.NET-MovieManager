@model MovieCardViewModel
@using MovieManager.Services
@using MovieManager.Data.DataModels
@using MovieManager.Models
@using System.Linq
@{
	ViewData["Title"] = "Review";
	var movieObj = Model.Movie;
	string posterMovieUrl = "https://image.tmdb.org/t/p/w500"+@movieObj.PosterPath;
}
@section scripts{
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
}
<head>
	<link href="~/css/style.css" asp-append-version="true" rel="stylesheet">
	<link href="~/css/styleReview.css" asp-append-version="true" rel="stylesheet">
</head>



<div class="MovieCard">
	<div class="flex-container">
	   <div class="flex-items">	
		   <a href="/Movie/MovieCard/@movieObj.Id">
				<img class="moviePoster" alt="Image" src="@posterMovieUrl"> 	
		   </a>
		</div>
		<!--Movie Data-->
		@if (User.Identity.IsAuthenticated)
		{
			<div class="flex-items">
				<h2 class="movieTitle">	Write a review of: @movieObj.Title </h2>
				<p class="movieRating"> <img class="IMDBStar" src="~/img/star.png"> @movieObj.VoteAverage/10 - Rating </p>
				<p class="movieDesc"> @movieObj.ReleaseDate </p>

				@using (Html.BeginForm("AddReviewToUsersReviews", "Button", new {  }, FormMethod.Post))
				{
					<label>Review Title</label>
					<input name="ReviewTitle" type="text"/><br>
					<label>Review Content</label>
					<input name="ReviewContent" type="text"/><br>
					<label>Rating</label>
					<input name="Rating" type="number" />
					<br>
					<input name="MovieId" value="@movieObj.Id" type="hidden"/>
					<input name="MovieTitle" value="@movieObj.Title" type="hidden"/>

					<input type="submit" value="Post Review at using"/>
				}
			</div>
		}
		else
		{
			<div class="flex-items">
			<h2 class="movieTitle">	@movieObj.Title </h2>
			<p class="movieRating"> <img class="IMDBStar" src="~/img/star.png"> @movieObj.VoteAverage/10 - Rating <p class="movieDesc"> @movieObj.ReleaseDate </p>
			<p class="movieDesc"> @movieObj.Overview </p>
			</div>
		}
	</div>
</div>


<div class="ReviewsContainer">
	@foreach(var review in Model.Reviews){
		<h2 class="ReviewAuthor">Author: @review.Author</h2>
		<p class="ReviewContent">Review: @review.Content</p>
	}
</div>