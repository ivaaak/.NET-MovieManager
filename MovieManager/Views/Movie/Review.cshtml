@model MovieCardViewModel
@using MovieManager.Services
@using MovieManager.Data.DataModels
@using MovieManager.Models
@using System.Linq
@{
	ViewData["Title"] = "Review";
	var movieObj = Model.Movie;
	string posterMovieUrl = "https://image.tmdb.org/t/p/w500"+@movieObj.PosterPath;
	ReviewViewModel rvm = new ReviewViewModel();
}
@section scripts{
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
}
<head>
	<link href="~/css/style.css" asp-append-version="true" rel="stylesheet">
	<link href="~/css/styleReview.css" asp-append-version="true" rel="stylesheet">
</head>



<div class="MovieCard">
	<div class="flex-container">
	   <div class="flex-items">	
		   <a href="/Movie/MovieCard/@movieObj.Id">
				<img class="moviePoster" alt="Image" src="@posterMovieUrl"> 	
		   </a>
		</div>
		<!--Movie Data-->
		@if (User.Identity.IsAuthenticated)
		{
			<div class="flex-items">
				<h2 class="movieTitle">	Write a review of: @movieObj.Title </h2>
				<p class="movieRating"> <img class="IMDBStar" src="~/img/star.png"> @movieObj.VoteAverage/10 - Rating </p>
				<p class="movieDesc"> @movieObj.ReleaseDate </p>

				@using (Html.BeginForm("MovieList", "Movie", new { }, FormMethod.Post))
					{
					<div class="form-group">
						<label asp-for="@rvm.ReviewTitle"></label>
						<input asp-for="@rvm.ReviewTitle" class="form-control" placeholder="">
						<span asp-validation-for="@rvm.ReviewTitle" class="small text-danger"></span>
					</div>
					<div class="form-group">
						<label asp-for="@rvm.ReviewContent"></label>
						<input asp-for="@rvm.ReviewContent" class="form-control" placeholder="">
						<span asp-validation-for="@rvm.ReviewContent" class="small text-danger"></span>
					</div>

					<input class="btn btn-primary mt-3" type="submit" value="Post Review" />
				}
			</div>
		}
		else
		{
			<div class="flex-items">
			<h2 class="movieTitle">	@movieObj.Title </h2>
			<p class="movieRating"> <img class="IMDBStar" src="~/img/star.png"> @movieObj.VoteAverage/10 - Rating <p class="movieDesc"> @movieObj.ReleaseDate </p>
			<p class="movieDesc"> @movieObj.Overview </p>
			</div>
		}
	</div>
</div>


<div class="ReviewsContainer">
	@foreach(var review in Model.Reviews){
		<h2 class="ReviewAuthor">Author: @review.Author</h2>
		<p class="ReviewContent">Review: @review.Content</p>
	}
</div>





<!--
<form method="get" asp-action="AddReviewToUsersReviews" asp-controller="Button">
	Review Title: <input type="text" name="reviewTitle">
	Review Content: <textarea name="reviewContent" cols="60" rows="15"></textarea>
	Rating : <input type="number" name="rating">

	<input type="submit" value="Submit">
</form>
-->